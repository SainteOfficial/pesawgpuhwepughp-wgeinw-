-- LocalScript für Backpack-Items

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")

-- Module importieren
local RuntimeLib = require(ReplicatedStorage:WaitForChild("rbxts_include"):WaitForChild("RuntimeLib"))
local UserBackpack = RuntimeLib.import(script, ReplicatedStorage, "TS", "user", "backpack", "user-backpack").UserBackpack
local ItemCategory = RuntimeLib.import(script, ReplicatedStorage, "TS", "item", "item-category").ItemCategory

-- Funktion zum Anzeigen der Backpack-Items
local function printBackpackItems()
    local player = Players.LocalPlayer
    
    -- Warten bis der Spieler geladen ist
    if not player then
        player = Players.LocalPlayer or Players:GetPropertyChangedSignal("LocalPlayer"):Wait()
    end
    
    -- UserBackpack-Instanz erstellen
    local backpack = UserBackpack.new(player)
    
    -- Alle Items abrufen
    local items = backpack:getItems()
    
    -- Überprüfen ob Items vorhanden sind
    if #items == 0 then
        print("Keine Items im Backpack gefunden!")
        return
    end
    
    print("------------- BACKPACK ITEMS -------------")
    for _, item in pairs(items) do
        -- Informationen über jedes Item ausgeben
        local itemData = item.item
        local quantity = item:getDocument().quantity
        
        print("ID:", itemData.id)
        print("Name:", itemData.name or "Unbekannt")
        print("Kategorie:", itemData.category or "Unbekannt")
        print("Menge:", quantity)
        
        -- Überprüfen ob das Item ausgerüstet ist (HIER WURDE DER FEHLER BEHOBEN)
        local equipStatus = "Nein"
        if item:isEquipped() or item.equipped then
            equipStatus = "Ja"
        end
        print("Ausgerüstet:", equipStatus)
        
        -- Spezielle Kategorien überprüfen
        if itemData.category == ItemCategory.TITLE or itemData.category == ItemCategory.EQUIPMENT or itemData.category == ItemCategory.ARTIFACT then
            print("Spezial-Kategorie:", itemData.category)
        end
        
        print("---------------------------------------")
    end
end

-- Skript bei Spielerbeitritt ausführen
Players.PlayerAdded:Connect(function(player)
    if player == Players.LocalPlayer then
        task.wait(1)
        printBackpackItems()
    end
end)

-- Falls der Spieler bereits geladen ist
if Players.LocalPlayer then
    task.wait(1)
    printBackpackItems()
end
